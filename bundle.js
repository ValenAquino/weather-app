(()=>{"use strict";var t={d:(e,r)=>{for(var s in r)t.o(r,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{X:()=>h});class e{constructor(){this.location=document.querySelector(".city-name"),this.temp=document.querySelector(".temp"),this.cond=document.querySelector(".city-cond"),this.time=document.querySelector(".city-time"),this.date=document.querySelector(".city-date"),this.icon=document.querySelector("#icon-weather"),this.url="https://openweathermap.org/img/wn/"}renderDate(t){let e=a(t);this.time.textContent=`${e.hours}:${e.minutes}`,this.date.textContent=`${e.day}, ${e.month} ${e.date}`}render(t){this.renderDate(t.timezone),this.location.textContent=t.name,this.temp.textContent=Math.trunc(t.main.temp)+"Â°",this.cond.textContent=t.weather[0].main,this.icon.setAttribute("src",this.url+`${t.weather[0].icon}@2x.png`)}}class r{constructor(){this.cloudy=document.querySelector("#cloudy"),this.humidity=document.querySelector("#humidity"),this.wind=document.querySelector("#wind")}render(t){this.humidity.textContent=t.main.humidity,this.wind.textContent=t.wind.speed+" m/s",this.cloudy.textContent=t.clouds.all+"%"}}class s{constructor(){this.fst_search=document.querySelector("#fst-search"),this.snd_search=document.querySelector("#snd-search"),this.trd_search=document.querySelector("#trd-search"),this.turn=0}handleNewSearch(t,e){t.classList.remove("display_none"),t.textContent=`${e.city}, ${e.country}`}addSearch(t){switch(this.turn){case 0:return this.handleNewSearch(this.fst_search,t),this.turn++,this.fst_search;case 1:return this.handleNewSearch(this.snd_search,t),this.turn++,this.snd_search;case 2:return this.handleNewSearch(this.trd_search,t),this.turn=0,this.trd_search}}}function a(t){const e=Date.now()+t/3600*1e3,r=new Date(e),s="en-US";let a=r.toLocaleString(s,{weekday:"long"}),n=r.toLocaleString(s,{day:"numeric"}),c=r.toLocaleString("en-US",{month:"long"}),i=a.slice(0,3),o=c.slice(0,3);return{day:i,date:n,hours:r.getHours(),minutes:r.getMinutes(),month:o}}class n{constructor(t,e){this.apiKey="2aef1cdc722f7b0ad237c469efb33d2a",this.url="https://api.openweathermap.org/data/2.5/",this.city=t,this.country=e}getCurrentWeather(){return`weather?q=${this.city},${this.country}&appid=${this.apiKey}&units=metric`}getForecast(){return`forecast?q=${this.city},${this.country}&appid=${this.apiKey}&units=metric`}async fetchData(t){let e=await fetch(this.url+t),r=await e.json();return 404!=r.cod?r:r.cod}async fetchCurrentData(){let t=this.getCurrentWeather();return await this.fetchData(t)}async fetch5DaysData(){let t=this.getForecast();return await this.fetchData(t)}}let c=new s;const i=new class{constructor(){this.widget=new e,this.aside=new r,this.searchHandler=new s}render(t){404==t?alert("Not found"):(this.widget.render(t),this.aside.render(t),this.changeBackground(t.weather[0].main,t.timezone))}addSearch(t){this.searchHandler.addSearch(t).addEventListener("click",(e=>{h(t.city,t.country)}))}changeBackground(t,e){let r=document.querySelector("#body"),s="";var n;s+=(n=a(e).hours)<=19&&n<=6?"day":"night",t.includes("Snow")?s+="-snowy":t.includes("Clouds")?s+="-cloudy":t.includes("Clear")?s+="-clear":t.includes("Rain")&&(s+="-rainy"),r.classList="",r.classList.add(s)}},o=document.querySelector(".location-form");async function h(t,e){let r=new n(t,e),s=await r.fetchCurrentData(),a=await r.fetch5DaysData();console.log(a),i.render(s),i.addSearch(r)}o.addEventListener("submit",(t=>{const e=document.querySelector("#city-input").value,r=document.querySelector("#country-input").value;0==e.length||0==r.length?alert("Please, enter city and country"):h(e,r),t.preventDefault(),o.reset()})),class{static restore_storage(){let t=localStorage.getItem("latest");return!!t&&(this.latest_searches=JSON.parse(t),this.latest_searches.forEach((t=>{c.addSearch(t)})),!0)}static save_storage(t){this.latest_searches.push(t),localStorage.setItem("latest",JSON.stringify(this.latest_searches))}}.restore_storage()||h("Bernal","Ar")})();